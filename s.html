<!DOCTYPE html>
<html lang="ne"> <!-- Set language to Nepali -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>फारम भर्नुहोस्</title> <!-- Fill the Form -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Roboto', 'Noto Sans Nepali', sans-serif; /* Added Noto Sans Nepali for better Nepali font rendering */
            background: linear-gradient(135deg, #6DD5FA, #FF758C); /* Vibrant gradient */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            color: #333;
        }

        .form-container {
            background-color: #ffffff;
            padding: 35px 45px; /* Increased padding */
            border-radius: 15px; /* More rounded */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2); /* Softer, deeper shadow */
            width: 100%;
            max-width: 550px; /* Slightly wider */
            text-align: center;
        }

        h1 {
            color: #2c3e50; /* Professional dark blue */
            margin-bottom: 30px;
            font-size: 30px; /* Larger title */
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 25px; /* Increased spacing */
            position: relative;
            text-align: left;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px; /* More space below label */
            color: #555;
            font-size: 17px; /* Larger labels */
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-wrapper i {
            position: absolute;
            left: 18px; /* Adjusted for larger padding */
            top: 50%;
            transform: translateY(-50%);
            color: #FF758C; /* Vibrant icon color */
            font-size: 22px; /* Larger icons */
        }

        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="password"] {
            width: 100%;
            padding: 18px 18px 18px 60px; /* Larger padding, left padding for icon */
            border: 1px solid #ccc;
            border-radius: 10px; /* More rounded inputs */
            box-sizing: border-box;
            font-size: 17px; /* Larger font in input */
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="email"]:focus,
        .form-group input[type="password"]:focus {
            border-color: #6DD5FA;
            box-shadow: 0 0 0 4px rgba(109, 213, 250, 0.3);
            outline: none;
        }

        .password-note {
            font-size: 0.85em;
            color: #666;
            margin-left: 5px;
            font-style: italic;
        }

        .checkbox-group {
            margin-bottom: 30px;
            display: flex;
            align-items: flex-start; /* Align items to start for multiline labels */
            text-align: left;
            position: relative; /* For error message positioning */
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 12px;
            margin-top: 4px; /* Align with first line of text */
            width: 22px; /* Larger checkbox */
            height: 22px;
            accent-color: #FF758C;
            cursor: pointer;
            flex-shrink: 0; /* Prevent checkbox from shrinking */
        }

        .checkbox-group label {
            font-size: 16px; /* Slightly larger checkbox label */
            color: #555;
            cursor: pointer;
            line-height: 1.5;
            font-weight: normal; /* Regular weight for checkbox label */
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 8px;
            display: block;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            position: relative;
            padding-left: 20px; /* Space for arrow */
            line-height: 1.3;
        }

        .error-message.visible {
            visibility: visible;
            opacity: 1;
        }

        /* Tooltip arrow for error messages */
        .error-message.visible::before {
            content: '';
            position: absolute;
            top: 2px; /* Adjust to point to the middle of first line of text */
            left: 5px; /* Position arrow near the start of the message */
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 8px solid #e74c3c; /* Pointing right */
        }
        /* For checkbox, error appears below */
        .checkbox-group .error-message.visible::before {
             /* Standard error message style applies, appears below checkbox group */
            top: -8px; /* Pointing upwards to the checkbox area */
            left: 10px;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 8px solid #e74c3c;
            border-top: 0;
        }


        button[type="submit"] {
            background: linear-gradient(135deg, #6DD5FA, #FF758C);
            color: white;
            padding: 18px 30px; /* Larger button */
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 19px; /* Larger font */
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
            letter-spacing: 0.5px;
        }

        button[type="submit"]:hover {
            background: linear-gradient(135deg, #5BC6E8, #F76C80);
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        button[type="submit"]:active {
            transform: translateY(-1px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        #statusMessage {
            margin-top: 25px;
            font-weight: bold;
            font-size: 16px;
        }

        /* Thank you message styling */
        #thankYouSection { /* Changed ID for clarity */
            padding: 30px;
            text-align: center;
        }

        #thankYouSection h2 {
            color: #27ae60; /* Green for success */
            margin-bottom: 20px;
            font-size: 28px;
        }

        #thankYouSection p {
            font-size: 19px;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        #thankYouSection .back-button {
            background-color: #3498db; /* Professional blue */
            color: white;
            padding: 14px 28px;
            text-decoration: none;
            border-radius: 10px;
            font-size: 17px;
            transition: background-color 0.3s, transform 0.2s;
            display: inline-block; /* To apply transform */
        }

        #thankYouSection .back-button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="form-container">
        <form id="customForm">
            <h1>फारम भर्नुहोस्</h1> <!-- Fill the Form -->

            <div class="form-group">
                <label for="firstName">पहिलो नाम:</label> <!-- First Name -->
                <div class="input-wrapper">
                    <i class="fas fa-user"></i>
                    <input type="text" id="firstName" name="firstName" placeholder="हजुरको नाम" required>
                </div>
                <span class="error-message" id="firstNameError"></span>
            </div>

            <div class="form-group">
                <label for="email">ईमेल:</label> <!-- Email -->
                <div class="input-wrapper">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="email" name="email" placeholder="हजुरको ईमेल" required>
                </div>
                <span class="error-message" id="emailError"></span>
            </div>

            <div class="form-group">
                <label for="password">पासवर्ड: <span class="password-note">(आफ्नो वास्तविक पासवर्ड प्रयोग नगर्नुहोस्)</span></label>
                <div class="input-wrapper">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="password" name="password" placeholder="हजुरले चाहेको पासवर्ड" required>
                </div>
                <span class="error-message" id="passwordError"></span>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="consent" name="consent" value="yes" required>
                <label for="consent">म लगइन सम्बन्धी मेल प्राप्त गर्न सहमत छु।</label>
            </div>
            <!-- Error for checkbox will appear below the group -->
            <span class="error-message" id="consentError"></span>


            <button type="submit">पेश गर्नुहोस्</button> <!-- Submit -->
            <div id="statusMessage"></div>
        </form>

        <div id="thankYouSection" style="display: none;">
            <!-- Content will be injected by JavaScript -->
        </div>
    </div>

    <script>
        const form = document.getElementById('customForm');
        const statusMessageDiv = document.getElementById('statusMessage');
        const thankYouSectionDiv = document.getElementById('thankYouSection');
        const formContainer = document.querySelector('.form-container form'); // Select the form element itself

        // IMPORTANT: Replace with YOUR Google Apps Script Web App URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx1mXpaaMN_hRbS-vZOvFxxOECdbWxP-wkHY4ENFOwJ6kRkhlJKjzcPXpW8FCHIeIkY/exec';

        function displayError(fieldId, message) {
            const errorSpan = document.getElementById(fieldId + 'Error');
            const inputField = document.getElementById(fieldId);
            if (errorSpan) {
                errorSpan.textContent = message;
                errorSpan.classList.add('visible');
            }
            if (inputField && inputField.type !== 'checkbox') { // Don't border the checkbox itself
                inputField.style.borderColor = '#e74c3c';
                inputField.parentElement.style.boxShadow = '0 0 0 2px rgba(231, 76, 60, 0.2)'; // Highlight wrapper
            } else if (inputField && inputField.type === 'checkbox') {
                 // Optionally style the checkbox label or container
                const checkboxLabel = document.querySelector(`label[for='${fieldId}']`);
                if(checkboxLabel) checkboxLabel.style.color = '#e74c3c';
            }
        }

        function clearErrors() {
            document.querySelectorAll('.error-message').forEach(span => {
                span.textContent = '';
                span.classList.remove('visible');
            });
            form.querySelectorAll('input[type="text"], input[type="email"], input[type="password"]').forEach(input => {
                input.style.borderColor = '#ccc';
                input.parentElement.style.boxShadow = 'none';
            });
            const consentLabel = document.querySelector("label[for='consent']");
            if(consentLabel) consentLabel.style.color = '#555'; // Reset color
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            clearErrors();
            statusMessageDiv.textContent = '';

            let isValid = true;

            const firstName = document.getElementById('firstName').value.trim();
            const emailVal = document.getElementById('email').value.trim(); // Renamed to avoid conflict
            const passwordVal = document.getElementById('password').value; // Renamed
            const consentChecked = document.getElementById('consent').checked; // Renamed

            if (!firstName) {
                displayError('firstName', 'कृपया आफ्नो पहिलो नाम भर्नुहोस्।');
                isValid = false;
            }
            if (!emailVal) {
                displayError('email', 'कृपया आफ्नो ईमेल ठेगाना भर्नुहोस्।');
                isValid = false;
            } else {
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(emailVal)) {
                    displayError('email', 'कृपया मान्य ईमेल ठेगाना भर्नुहोस्।');
                    isValid = false;
                }
            }
            if (!passwordVal) {
                displayError('password', 'कृपया पासवर्ड भर्नुहोस्।');
                isValid = false;
            }
            if (!consentChecked) {
                displayError('consent', 'तपाईंले मेल प्राप्त गर्न सहमत हुनुपर्छ।');
                isValid = false;
            }

            if (!isValid) {
                statusMessageDiv.textContent = 'कृपया सबै आवश्यक फिल्डहरू सही तरिकाले भर्नुहोस्।';
                statusMessageDiv.style.color = '#e74c3c';
                // Focus the first invalid field
                const firstError = document.querySelector('.error-message.visible');
                if (firstError) {
                    const fieldId = firstError.id.replace('Error', '');
                    document.getElementById(fieldId)?.focus();
                }
                return;
            }

            statusMessageDiv.textContent = 'पेश गर्दै...'; // Submitting...
            statusMessageDiv.style.color = '#FF758C'; // Use a theme color

            const formData = new FormData(form);
            // FormData directly uses the 'name' attribute from HTML inputs.
            // 'consent' will be 'yes' if checked (due to value="yes"), or not present if unchecked.
            // Let's ensure it's always present for the script.
            if (!formData.has('consent')) {
                formData.append('consent', 'no'); // Or false
            }


            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();

                if (result.result === "success") {
                    formContainer.style.display = 'none'; // Hide form
                    statusMessageDiv.style.display = 'none';
                    thankYouSectionDiv.innerHTML = `
                        <h2>धन्यवाद!</h2>
                        <p>फारम भर्नु भएकोमा धन्यवाद। हामी तपाईंलाई सकेसम्म चाँडो सम्पर्क गर्नेछौं।</p>
                        <a href="index.html" class="back-button">गृह पृष्ठमा फर्कनुहोस्</a>
                    `; // Thank you... // Go back to Home Page
                    thankYouSectionDiv.style.display = 'block';
                } else {
                    statusMessageDiv.textContent = `त्रुटि: ${result.message || 'पेश गर्न सकिएन।'}`;
                    statusMessageDiv.style.color = '#e74c3c';
                }
            } catch (error) {
                statusMessageDiv.textContent = `नेटवर्क त्रुटि: ${error.message || 'सर्भरमा जडान हुन सकेन।'}`;
                statusMessageDiv.style.color = '#e74c3c';
            }
        });
    </script>
</body>
</html>
